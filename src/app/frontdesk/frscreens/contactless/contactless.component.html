<div class="content-body">
    <div class="container-fluid">
        <div class="card shadow rounded-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">Check-In Request</h5>
                <a href="https://rsmguest.com/admin/hotel_images/qr_document" target="_blank"
                    title="Contactless CheckIn QR">
                    <img src="https://rsmguest.com/assets/images/015-qr-scan.png" alt="QR"
                        style="width:35px; height:35px;" />
                </a>
            </div>

            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered table-sm table_font" datatable [dtOptions]="checkin_datatable"
                        [dtTrigger]="dtTrigger">
                        <thead>
                            <tr>
                                <th class="text-center" scope="col">S.No</th>
                                <th scope="col">Type</th>
                                <th scope="col">ResID</th>
                                <th scope="col">BookingID</th>
                                <th class="text-center" scope="col">Check-In</th>
                                <th class="text-center" scope="col">Check-Out</th>
                                <th class="text-center" scope="col">Name</th>
                                <th class="text-center" scope="col">Mobile</th>
                                <th class="text-center" scope="col">No.of Rooms</th>
                                <th class="text-center" scope="col">Payment</th>
                                <th class="text-center" scope="col">View Docs</th>
                                <th class="text-center" scope="col"> <i class="fas fa-search fs-4"></i> </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="text-center" *ngFor="let guest of checkin_list; let i = index">
                                <td>{{ i + 1 }}</td>
                                <td>Website</td>
                                <td>{{ guest.reservationid }}</td>
                                <td>{{ guest.booking_id }}</td>
                                <td>{{ formatDateString(guest.checkin_date) }}</td>
                                <td>{{ formatDateString(guest.checkout_date) }}</td>
                                <td>{{ guest.guest_name || '—' }}</td>
                                <td>{{ guest.guest_mobile || '—' }}</td>
                                <td>{{ guest.checkout_nights }}</td>
                                <td>-</td>
                                <td class="text-blue">
                                    <i class="fas fa-file-alt fs-3 pointer-class" data-bs-toggle="modal"
                                        data-bs-target="#docModal" (click)="openDocsModal(guest)"></i>
                                </td>
                                <td>
                                    <i class="fa fa-bed text-danger fs-3 pointer-class"
                                        (click)="go_to_checkin(guest)"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
    </div>

</div>
<div class="modal fade" id="docModal" tabindex="-1" aria-labelledby="docModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="docModalLabel">
                    Documents for {{ selectedGuest?.guest_name }}
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body">
                <div *ngIf="selectedGuest?.docs?.length > 0; else noDocs">
                    <div class="row">
                        <div class="col-md-4 mb-4" *ngFor="let doc of selectedGuest.docs; let i = index">
                            <div class="card shadow-sm border text-center h-100">

                                <a [href]="doc.guest_document" target="_blank" class="d-block p-2">
                                    <img [src]="'http://rsmguest.com/guest/' + doc.guest_document"
                                        class="img-fluid rounded mx-auto d-block" [style.height.px]="150"
                                        [style.objectFit]="'cover'" alt="Document">

                                </a>

                                <div class="card-body p-2">
                                    <small class="text-muted d-block mb-2">{{doc.doc_type}} No: {{ doc.doc_number
                                        }}</small>

                                    <!-- Delete Button -->
                                    <button class="btn btn-sm btn-danger" (click)="deleteDocument(doc, i)">
                                        <i class="fa fa-trash me-1"></i> Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Add File Button -->
                    <div class="text-center my-3">
                        <label class="btn btn-outline-primary btn-sm">
                            <i class="fa fa-plus me-1"></i> Add File
                            <input type="file" hidden (change)="addDocument($event)">
                        </label>
                    </div>
                </div>

                <ng-template #noDocs>
                    <p class="text-muted">No documents available.</p>
                </ng-template>
            </div>
        </div>
    </div>
</div>